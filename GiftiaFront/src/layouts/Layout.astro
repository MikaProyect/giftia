---
import { BackAdmin } from "../components/UI/BackAdmin";
interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Astro description" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/img/logo-white.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins&display=swap"
      rel="stylesheet"
    />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body class="poppins-regular">

    <!-- Cambio del diseño según festividades-->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const sidebar = document.querySelector(".izq") as HTMLElement;
    
        function CambiarFondo() {
          if (!sidebar) {
            console.error("El elemento .izq no se encontró en el DOM");
            return;
          }
    
          let date = new Date();
          let day = date.getDate();
          let month = date.getMonth() + 1;
          
          // if (day === 25 && month === 6) {
          if (day === 14 && month === 2) {
            sidebar.style.backgroundImage = "url('../img/FondoValentin.png')"
            console.log("Fondo de San Valentin aplicado");
          }

          // if (day === 25 && month === 6) {
          if (day === 11 && month === 5) {
            sidebar.style.backgroundImage = "url('../img/FondoMadre.png')"
            console.log("Fondo dia de la madre aplicado");
          }

          // if (day === 25 && month === 6) {
          if (day === 16 && month === 6) {
            sidebar.style.backgroundImage = "url('../img/FondoPadre.png')"
            console.log("Fondo dia del padre aplicado");
          }

          // if (day === 25 && month === 6) {
          if (day === 11 && month === 8) {
            sidebar.style.backgroundImage = "url('../img/FondoNiño.png')"
            console.log("Fondo dia del niño aplicado");
          }
          
          // if (day === 25 && month === 6) {
          if (day === 25 && month === 12) {
            sidebar.style.backgroundImage = "url('../img/FondoNavideño.png')"
            console.log("Fondo Navideño aplicado");
          }

        }
    
        CambiarFondo();
      });
    </script>
    
    
    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>

    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <div class="page">
      <div class="left">
        <div class="izq">
          <!--Contenedor del lado izquierdo-->
          <img class="logok" src="../img/logoName-white.png" alt="logo" />

          <!--PENDIENTE-->
          <ul>
            <li><BackAdmin client:load /></li>
            <li>
              <a class="CT" href=""
                ><ion-icon name="person-circle-outline" title="Mi cuenta"
                ></ion-icon></a
              >
            </li>
            <li>
              <a class="GT" href="/chat"
                ><ion-icon name="gift-outline" title="Chat"></ion-icon></a
              >
            </li>
            <li>
              <a class="OP" href="/rys"
                ><ion-icon
                  name="heart-circle-outline"
                  title="Reclamos y Sugerencias"></ion-icon></a
              >
            </li>
            <li>
              <a class="MS" href="/solicitudes"
                ><ion-icon
                  name="ellipsis-horizontal-circle-outline"
                  title="Mis Solicitudes"></ion-icon></a
              >
            </li>
            <li>
              <a class="SL" id="salir" href=""
                ><ion-icon name="exit-outline" title="Salir"></ion-icon></a
              >
            </li>
          </ul>
        </div>
      </div>
      <div class="right">
        <slot />
      </div>
    </div>
  </body>
  <script>
    import { getItem } from "../functions/localStorage.js";
    import { verifyUserAPI } from "../api/auth.js";
    document.addEventListener("DOMContentLoaded", async () => {
      const user = getItem("user");
      if (user) {
        const res = await verifyUserAPI(user.id);
        if (res === "Token invalid") {
          window.location.href = "/";
        }
      } else {
        if (!user) {
          window.location.href = "/";
        }
      }
    });
    const salir = document.querySelector("#salir");
    salir.addEventListener("click", async (e) => {
    e.preventDefault();
      try {
        const res = await fetch("http://localhost:3000/api/logout", {
          method: "POST",
        });
        const data = await res.json();
        if (data.error === null) {
          localStorage.removeItem("user");
          window.location.href = "/";
        }
      } catch (error) {
        console.log("Ha ocurrido un error: ", error);
      }
    });
  </script>

</html>


<style is:global>
  :root {
    --accent: 136, 58, 234;
    --accent-light: 224, 204, 250;
    --accent-dark: 49, 10, 101;
    --accent-gradient: linear-gradient(
      45deg,
      rgb(var(--accent)),
      rgb(var(--accent-light)) 30%,
      white 60%
    );
  }

  .poppins-regular {
    font-family: "Poppins", sans-serif;
    font-weight: 400;
    font-style: normal;
  }

  * {
    padding: 0;
    box-sizing: border-box;
    margin: 0;
  }
  code {
    font-family:
      Menlo,
      Monaco,
      Lucida Console,
      Liberation Mono,
      DejaVu Sans Mono,
      Bitstream Vera Sans Mono,
      Courier New,
      monospace;
  }
  body {
    background: #202124;
    width: 100%;
    height: 100vh;
  }

  .page {
    display: flex;
    flex-direction: row;
    height: 90vh;
    width: auto;
    box-sizing: border-box;
  }

  .left {
    height: auto;
  }
  .right {
    width: 100%;
    height: 100%;
  }

  .izq {
    /*background-image: url('../img/FondoNavideño.png');*/
    background-size: cover;
    background-position: center;

    position: absolute;
    width: calc(13% - 40px); /* 13% - 20px de cada lado */
    height: calc(100% - 40px); /* 100% - 20px de arriba y abajo */
    background-color: #443C54; /*color de fondo*/
    z-index: 2; /* es para que esté sobre .cont-com */
    top: 20px; /* mueve 20px desde el borde superior */
    left: 20px; /* mueve 20px desde el borde izquierdo */
    border-radius: 10px; /* redondea las esquinas */
    border: 20px solid transparent; /* crea el borde de 20px */
    display: flex;
    flex-direction: column; /* alinea los elementos verticalmente */
    justify-content: flex-start; /* alinea los elementos al principio */
    align-items: center; /* alinea los elementos al centro horizontalmente */
    border: 1px solid #CBA3FB;
  }

  .logok {
    width: 40%;
    max-width: 230px;
    min-width: 110px;
    display: block;
    position: relative; /* Cambiamos la posición a relativa */
    margin-top: 30px; /* Agregamos un margen superior */
  }

  .CT,
  .SL,
  .OP,
  .GT,
  .MS {
    text-align: center;
    list-style-type: none;
    margin: 10px 0; /* Agregamos un margen entre los elementos */
    font-size: 45px;
    color: #CBA3FB;
  }
  li {
    list-style: none;
  }

  ul {
    margin-top: 25vh;
  }
</style>
