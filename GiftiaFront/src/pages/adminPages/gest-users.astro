---
import AdminLayout from "../../layouts/AdminLayout.astro";
import { UserTable } from "../../components/UsersTable/UserTable";
import { profileAPI } from "../../api/auth.js";

const user = await profileAPI();
if (user !== 'error') {
  if (user === 'user not logged') {
    return Astro.redirect("/login");
  } else {
    if (user.role !== 'admin') {
    return Astro.redirect("/chat");
    }
  }
} else {
  console.log('Ha ocurrido un error: ', user);
}
---

<AdminLayout title="GestiÃ³n  de Usuarios">
  <UserTable client:visible />
</AdminLayout>